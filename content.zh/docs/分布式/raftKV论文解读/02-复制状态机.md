---
title: "02-复制状态机"
weight: 1
# bookFlatSection: false
# bookToc: true
# bookHidden: false
# bookCollapseSection: true
# bookComments: false
# bookSearchExclude: false
# bookHref: ''
# bookIcon: ''
---

# 复制状态机

## 介绍

- 通常基于复制日志实现
- 结构（服务器/复制状态机 = 共识模块 + 状态机 + 日志）
- 一致性算法任务：保证日志复制的一致性（位置/顺序 + 内容）

## 扩展

从客户端的角度看集群特性：强一致性、最终一致性、弱一致性

对客户端而言是集群系统整体，**或者说，这些表现的特性是对于客户端的写入和读取的结果而言的**

### 强一致性

故障节点被**暂时排除出有效节点集**，**多数派有效节点**先完成日志共识（同步 + 确认），再执行并返回结果，客户端只能访问有效节点，因此拿到的永远是集群统一的准确结果；

### 最终一致性（属于弱一致性的扩展）

最终一致性（弱一致性的实用版）：**故障 / 同步滞后节点不会被立即排除，仍可能参与请求处理**，日志异步后台同步，因此写后立即读可能出现新旧数据不一致，但只要无新写操作，经过同步窗口期，所有节点最终会达成数据一致；

**最终一致性 = 弱一致性 + 最终一致的收敛保障**

### 弱一致性（无工业实用性）

写操作完成后，后续读操作可能立刻读到新值、可能读到旧值、无任何确定的时序保障，完全依赖系统同步时机，客户端无法预期；